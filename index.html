<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z≈Çap Cel! - Gra Zrƒôczno≈õciowa (Wersja MAX)</title>
    
    <meta name="description" content="Przebudowana gra 'Z≈Çap Cel!'. Sprawd≈∫ sw√≥j refleks na r√≥≈ºnych poziomach trudno≈õci. Jak szybko potrafisz klikaƒá? Zagraj teraz i pobij sw√≥j rekord.">

    <!-- Skrypt Google AdSense (poprawny) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7782110146823036"
     crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Oswald:wght@500;700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

    <style>
        /* === GLOBALNY RESET I MOTYW === */
        :root {
            /* Domy≈õlny motyw to JASNY */
            --color-bg: #F0F2F5; /* Jasnoszare t≈Ço */
            --color-bg-container: #FFFFFF; /* Bia≈Çe kontenery */
            --color-text: #1a1a1a; /* Ciemny tekst */
            --color-text-secondary: #555555;
            --color-border: #DDE1E6; /* Jasne obramowania */
    
            /* Wsp√≥lne */
            --color-primary: #00A8FF; 
            --color-secondary: #4CAF50; 
            --color-accent: #FF3B3B;   
            --font-body: 'Inter', Arial, sans-serif;
            --font-heading: 'Oswald', sans-serif;
        }
    
        /* Klasa .dark-theme aktywuje tryb ciemny */
        body.dark-theme {
            --color-bg: #121212;
            --color-bg-container: #1E1E1E;
            --color-text: #E0E0E0;
            --color-text-secondary: #AAAAAA;
            --color-border: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            text-align: center;
            background-color: var(--color-bg);
            color: var(--color-text);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Gradient t≈Ça tylko dla motywu ciemnego */
        body.dark-theme {
            background-image: radial-gradient(circle at center, #2a2a2a 0%, var(--color-bg) 70%);
        }

        /* === NAG≈Å√ìWEK I NAWIGACJA === */
        header {
            background-color: var(--color-bg-container);
            /* Kolor tekstu w nag≈Ç√≥wku */
            color: var(--color-text);
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* L≈ºejszy cie≈Ñ */
            border-bottom: 2px solid var(--color-border);
            transition: background-color 0.3s, border-color 0.3s;
        }

        header h1 {
            margin: 0;
            font-family: var(--font-heading);
            font-size: 2.8em;
            font-weight: 700;
            color: var(--color-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        nav ul {
            padding: 0;
            margin: 10px 0 0;
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
        }

        nav a {
            color: var(--color-primary);
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1em;
            transition: color 0.2s, transform 0.2s;
        }

        nav a:hover {
            /* Poprawka koloru hover w motywie jasnym */
            color: #0077b3; 
            text-decoration: underline;
            transform: scale(1.05);
        }
        body.dark-theme nav a:hover {
             color: #ffffff; /* Zachowanie z motywu ciemnego */
        }

        #theme-toggle-button {
            background: var(--color-border);
            color: var(--color-text);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            transition: background 0.2s, transform 0.2s, color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #theme-toggle-button:hover {
            background: var(--color-primary);
            color: #ffffff; /* Zawsze bia≈Çy tekst na niebieskim tle */
            transform: scale(1.1);
        }

        /* === G≈Å√ìWNY KONTENER TRE≈öCI === */
        main.container {
            max-width: 960px;
            margin: 30px auto;
            padding: 25px;
            background-color: var(--color-bg-container);
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.1); /* L≈ºejszy cie≈Ñ */
            transition: background-color 0.3s;
        }
         body.dark-theme main.container {
             box-shadow: 0 6px 15px rgba(0,0,0,0.4); /* Cie≈Ñ dla motywu ciemnego */
         }


        /* === SEKCJE TEKSTOWE === */
      .content-section {
            text-align: left;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--color-border);
            transition: border-color 0.3s;
        }

      .content-section h2 {
            font-family: var(--font-heading);
            font-weight: 500;
            color: var(--color-primary);
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: 5px;
            display: inline-block;
            font-size: 2em;
            margin-bottom: 15px;
        }

      .content-section p,.content-section ul {
            font-size: 1.1em;
            color: var(--color-text);
             transition: color 0.3s;
        }
        
      .content-section li {
            margin-bottom: 10px;
            margin-left: 20px;
        }
      .content-section strong {
            color: var(--color-primary);
        }

        /* === KONTENERY REKLAM (Wszystkie) === */
      .ad-container {
            margin: 30px auto;
            text-align: center;
            padding: 20px 0;
            background-color: var(--color-bg); /* T≈Ço dopasowane do motywu */
            border-radius: 8px;
            min-height: 50px; 
            transition: background-color 0.3s;
        }

        /* === GRA - NOWE STYLE === */
        
        /* Poziomy Trudno≈õci */
        #difficulty-select {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

      .difficulty-button {
            font-family: var(--font-body);
            font-weight: bold;
            font-size: 16px;
            padding: 10px 20px;
            cursor: pointer;
            border: 2px solid var(--color-border);
            border-radius: 5px;
            background-color: var(--color-bg-container); /* Dopasowane t≈Ço */
            color: var(--color-text); /* Dopasowany tekst */
            transition: all 0.2s ease;
        }

      .difficulty-button:hover {
            background-color: var(--color-bg); /* Lekka zmiana t≈Ça przy najechaniu */
            transform: scale(1.05);
        }

      .difficulty-button.active {
            background-color: var(--color-primary);
            color: #ffffff; /* Bia≈Çy tekst na aktywnym */
            border-color: var(--color-primary);
            box-shadow: 0 0 10px rgba(0, 168, 255, 0.5);
        }
        /* Poprawka dla motywu jasnego, aby aktywny przycisk by≈Ç czytelny */
        body.light-theme .difficulty-button.active {
             color: #ffffff;
        }
         body.dark-theme .difficulty-button.active {
             color: var(--color-bg);
         }


        /* Interfejs Gry */
        #game-info {
            font-family: var(--font-heading);
            font-size: 28px;
            font-weight: 500;
            margin-bottom: 20px;
            letter-spacing: 1px;
            color: var(--color-text); /* Dopasowanie do motywu */
             transition: color 0.3s;
        }

        #game-info span {
            display: inline-block;
            min-width: 60px;
            padding: 5px 10px;
            background-color: var(--color-bg); /* Dopasowanie do motywu */
            border-radius: 5px;
            color: var(--color-primary);
             transition: background-color 0.3s;
        }
        #game-info #high-score {
            color: var(--color-secondary);
        }

        /* Przycisk Start (CTA) */
        #start-button {
            font-family: var(--font-heading);
            font-size: 28px;
            font-weight: 700;
            text-transform: uppercase;
            padding: 15px 35px;
            cursor: pointer;
            background-color: var(--color-secondary);
            color: white;
            border: none;
            border-radius: 8px;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 0 #388E3C;
            /* Animacja pulsowania */
            animation: pulse-glow 2s infinite;
        }

        #start-button:hover {
            background-color: #45a049;
            transform: scale(1.03);
            animation-play-state: paused; /* Pauza animacji przy najechaniu */
        }
        #start-button:active {
            transform: scale(0.98);
            box-shadow: 0 2px 0 #388E3C;
        }
        
        /* Animacja @keyframes dla przycisku Start */
        @keyframes pulse-glow {
            0% {
                transform: scale(1);
                box-shadow: 0 4px 0 #388E3C, 0 0 10px rgba(76, 175, 80, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 4px 0 #388E3C, 0 0 25px rgba(76, 175, 80, 0.8);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 4px 0 #388E3C, 0 0 10px rgba(76, 175, 80, 0.3);
            }
        }

        /* Obszar Gry */
        #game-area {
            width: 100%;
            max-width: 600px; 
            aspect-ratio: 4 / 3; /* Responsywno≈õƒá na mobilkach */
            height: auto; /* Zastƒôpuje sta≈ÇƒÖ wysoko≈õƒá */
            border: 3px solid var(--color-border);
            background-color: #ffffff;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            transition: box-shadow 0.5s ease, border-color 0.3s;
        }

        /* Animacja aktywnej ramki gry */
        #game-area.game-active {
            /* Animacja pulsujƒÖcej ramki */
            animation: glow-border 1.5s infinite alternate;
        }

        @keyframes glow-border {
            from {
                border-color: var(--color-border);
                box-shadow: 0 0 10px rgba(51, 51, 51, 0.5);
            }
            to {
                border-color: var(--color-primary);
                box-shadow: 0 0 20px rgba(0, 168, 255, 0.7), 0 0 10px rgba(0, 168, 255, 0.5) inset;
            }
        }

        /* Cel (Target) */
        #target {
            width: 50px;
            height: 50px;
            background-color: var(--color-accent);
            position: absolute;
            cursor: pointer;
            display: none;
            border-radius: 50%; /* Zmiana na ko≈Ço */
            box-shadow: 0 0 10px rgba(255, 59, 59, 0.5), 
                        inset 0 0 10px rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.7);
            /* U≈ºywamy animacji zamiast transition dla pojawienia siƒô */
            opacity: 0; 
        }

        #target.appear {
            animation: target-appear 0.2s ease-out forwards;
        }

        /* Animacja "wyskoku" celu */
        @keyframes target-appear {
            0% {
                transform: scale(0.5) translateY(20px);
                opacity: 0;
            }
            80% {
                transform: scale(1.1) translateY(0);
                opacity: 1;
            }
            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        /* Animacja "klikniƒôcia" celu */
        #target.clicked {
            transform: scale(0.9) rotate(5deg);
            background-color: #ff0000;
            transition: transform 0.05s ease;
        }

        /* === STOPKA === */
        footer {
            margin-top: 40px;
            padding: 30px;
            /* Dopasowanie t≈Ça stopki */
            background-color: var(--color-bg-container);
            color: var(--color-text-secondary);
            font-size: 14px;
            border-top: 1px solid var(--color-border);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        body.dark-theme footer {
             background-color: #111; /* Zachowanie z motywu ciemnego */
        }
        
        footer p {
            margin: 5px 0;
        }

        footer a {
            color: var(--color-primary);
            text-decoration: none;
            transition: color 0.2s;
        }

        footer a:hover {
            color: #0077b3; /* Dopasowanie hovera */
            text-decoration: underline;
        }
         body.dark-theme footer a:hover {
             color: #ffffff;
         }


        /* === DOSTOSOWANIE SWEETALERT2 DO MOTYWU === */
        /* Domy≈õlnie stylizujemy pod motyw jasny */
       .swal2-popup {
            background-color: #FFFFFF!important;
            color: #1a1a1a!important;
            border-radius: 12px!important;
        }
       .swal2-title {
            color: var(--color-primary)!important;
            font-family: var(--font-heading)!important;
        }
       .swal2-html-container {
            color: #1a1a1a!important;
            font-size: 1.2em!important;
        }
       .swal2-confirm {
            background-color: var(--color-primary)!important;
            font-size: 1.1em!important;
            border-radius: 5px!important;
        }
       .swal2-icon.swal2-success.swal2-success-ring {
            border-color: var(--color-secondary)!important;
        }
       .swal2-icon.swal2-success [class^=swal2-success-line] {
            background-color: var(--color-secondary)!important;
        }

        /* Nadpisanie dla motywu ciemnego */
        body.dark-theme .swal2-popup {
            background-color: var(--color-bg-container)!important;
            color: var(--color-text)!important;
        }
        body.dark-theme .swal2-html-container {
            color: var(--color-text)!important;
        }

    </style>
</head>
<body>

    <!-- ZMIANA: Reklamy "od innych" (pop-up) przeniesione na samƒÖ g√≥rƒô -->
    <div id="top-ad-scripts" style="text-align: center;">
        <!-- REKLAMY POP-UP (PRZENIESIONE NA G√ìRƒò) -->
        <script type="text/javascript" src="https://www.effectivegatecpm.com/v5hwx133ky?key=1395b32b485fc8345294fb34868b84bb"></script>
        <script type='text/javascript' src='//pl28008059.effectivegatecpm.com/ae/a0/f8/aea0f8601b5d2de4da8c48f64970bc09.js'></script>
    
        <!-- REKLAMY HIGHPERFORMANCE (PRZENIESIONE NA G√ìRƒò) -->
        <!-- Umieszczam je w .ad-container, aby mia≈Çy t≈Ço i marginesy -->
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : 'e57f905cb56d171f7a667907ea9d09ed',
                    'format' : 'iframe',
                    'height' : 250,
                    'width' : 300,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/e57f905cb56d171f7a667907ea9d09ed/invoke.js"></script>
        </div>
        
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : '0eb31f55c9c1dfb639e06d25e640027d',
                    'format' : 'iframe',
                    'height' : 600,
                    'width' : 160,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/0eb31f55c9c1dfb639e06d25e640027d/invoke.js"></script>
        </div>
        
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : '8b4a8b99c04cf58f2931d06cfab6d287',
                    'format' : 'iframe',
                    'height' : 300,
                    'width' : 160,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/8b4a8b99c04cf58f2931d06cfab6d287/invoke.js"></script>
        </div>
        
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : 'd09b3b9fc18d730293fd08d9393c6a9e',
                    'format' : 'iframe',
                    'height' : 60,
                    'width' : 468,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/d09b3b9fc18d730293fd08d9393c6a9e/invoke.js"></script>
        </div>
        
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : '786f8d1076514166c7b4445571f0809d',
                    'format' : 'iframe',
                    'height' : 50,
                    'width' : 320,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/786f8d1076514166c7b4445571f0809d/invoke.js"></script>
        </div>
    </div>


    <header>
        <h1>Gra: Z≈Çap Cel!</h1>
        <nav>
            <ul>
                <li><a href="/">Strona G≈Ç√≥wna</a></li>
                <li><a href="about.html">O nas</a></li>
                <li><a href="contact.html">Kontakt</a></li>
                <li><a href="https://fortstar77.github.io/privacy/" target="_blank" rel="noopener noreferrer">Polityka Prywatno≈õci</a></li>
                <!-- Domy≈õlna ikona to ksiƒô≈ºyc (bo motyw jest jasny) -->
                <li><button id="theme-toggle-button" aria-label="Zmie≈Ñ motyw">üåô</button></li>
            </ul>
        </nav>
    </header>

    <main class="container">

        <section class="content-section">
            <h2>Sprawd≈∫ sw√≥j refleks!</h2>
            <p>Witaj w "Z≈Çap Cel!" ‚Äì prostej, ale wciƒÖgajƒÖcej grze online, kt√≥ra przetestuje Tw√≥j refleks i szybko≈õƒá reakcji. Zasady sƒÖ banalnie proste, ale liczy siƒô ka≈ºda milisekunda. Wybierz poziom trudno≈õci i spr√≥buj pobiƒá sw√≥j najlepszy wynik!</p>
            <p>Nasza gra to idealny spos√≥b na kr√≥tkƒÖ przerwƒô w pracy lub nauce. Wystarczy chwila, aby rozruszaƒá umys≈Ç i sprawdziƒá, jak szybko potrafisz reagowaƒá. Powodzenia!</p>
        </section>
        
        <section class="content-section">
            <h2>Jak graƒá?</h2>
            <ul>
                <li>Wybierz poziom trudno≈õci: <strong>≈Åatwy, ≈öredni</strong> lub <strong>Trudny</strong>. Wp≈Çynie to na czas gry, rozmiar celu i szybko≈õƒá jego poruszania.</li>
                <li>Naci≈õnij wielki przycisk <strong>"Start!"</strong>, aby rozpoczƒÖƒá rundƒô.</li>
                <li>Gdy gra siƒô rozpocznie, na polu gry pojawi siƒô <strong>czerwony cel</strong>.</li>
                <li>Twoim zadaniem jest <strong>kliknƒÖƒá cel</strong> tak szybko, jak to mo≈ºliwe.</li>
                <li>Po ka≈ºdym trafieniu, cel natychmiast przeniesie siƒô w inne losowe miejsce.</li>
                <li><strong>Uwaga!</strong> Na wy≈ºszych poziomach, je≈õli nie trafisz celu wystarczajƒÖco szybko, sam zmieni on pozycjƒô!</li>
                <li>Po zako≈Ñczeniu czasu, zobaczysz sw√≥j wynik oraz najlepszy rekord. Naci≈õnij "Zagraj ponownie?", aby spr√≥bowaƒá go pobiƒá!</li>
            </ul>
        </section>

        <div id="difficulty-select">
            <button class="difficulty-button active" data-difficulty="easy">≈Åatwy</button>
            <button class="difficulty-button" data-difficulty="medium">≈öredni</button>
            <button class="difficulty-button" data-difficulty="hard">Trudny</button>
        </div>

        <div id="game-info" aria-live="polite" aria-atomic="true">
            Wynik: <span id="score">0</span> | Czas: <span id="time">0</span>s | Najlepszy: <span id="high-score">0</span>
        </div>

        <button id="start-button">Start!</button>

        <div id="game-area" aria-label="Obszar gry Z≈Çap Cel">
            <div id="target" role="button" tabindex="0" aria-label="Z≈Çap Czerwony Cel"></div>
        </div>

    </main> 

    <!-- ZMIANA: Reklamy Google AdSense przeniesione na d√≥≈Ç (przed stopkƒÖ) -->
    <div id="bottom-ads-google" style="text-align: center; background-color: var(--color-bg);">
        <!-- REKLAMY GOOGLE (1) -->
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7782110146823036"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        <!-- REKLAMY GOOGLE (2) -->
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7782110146823036"
                 data-ad-slot="9876543210"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </div>
    
    <footer>
        <p>¬© 2025 FortStar77. Wszelkie prawa zastrze≈ºone.</p>
        <p>
            <a href="about.html">O nas</a> | 
            <a href="contact.html">Kontakt</a> | 
            <a href="https://fortstar77.github.io/privacy/" target="_blank" rel="noopener noreferrer">Polityka prywatno≈õci</a>
        </p>
    </footer>

    <audio id="sound-click" src="https://raw.githubusercontent.com/kittykatattack/soundForGames/master/sounds/shoot.wav" preload="auto"></audio>
    <audio id="sound-end" src="https://raw.githubusercontent.com/kittykatattack/soundForGames/master/sounds/music.wav" preload="auto"></audio>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. REFERENCJE DO ELEMENT√ìW DOM ---
            const DOM = {
                target: document.getElementById('target'),
                gameArea: document.getElementById('game-area'),
                scoreDisplay: document.getElementById('score'),
                timeDisplay: document.getElementById('time'),
                highScoreDisplay: document.getElementById('high-score'),
                startButton: document.getElementById('start-button'),
                gameInfo: document.getElementById('game-info'),
                difficultyButtons: document.querySelectorAll('.difficulty-button'),
                themeToggleButton: document.getElementById('theme-toggle-button') // Dodany przycisk
            };

            // --- 2. REFERENCJE DO D≈πWIƒòK√ìW ---
            const Sounds = {
                click: document.getElementById('sound-click'),
                end: document.getElementById('sound-end')
            };

            // --- 3. USTAWIENIA POZIOM√ìW TRUDNO≈öCI ---
            const difficultySettings = {
                easy: { time: 20, size: 60, interval: 1000 }, // Interwa≈Ç w ms (1s)
                medium: { time: 15, size: 50, interval: 700 }, // (0.7s)
                hard: { time: 10, size: 30, interval: 450 }  // (0.45s)
            };

            // --- 4. STAN GRY I KONFIGURACJA ---
            let gameState = {
                score: 0,
                timeLeft: 0,
                isGameRunning: false,
                gameTimer: null,
                targetInterval: null, // Timer dla automatycznego ruchu celu
                highScore: 0
            };

            let gameConfig = {...difficultySettings.easy }; // Domy≈õlnie ≈Çatwy

            // --- 5. G≈Å√ìWNE FUNKCJE GRY ---

            /**
             * Inicjalizuje grƒô: wczytuje najlepszy wynik i ustawia listenery
             */
            function initGame() {
                loadHighScore();
                updateUI();
                DOM.startButton.addEventListener('click', startGame);
                DOM.target.addEventListener('click', handleTargetClick);
                
                // Listener dla klawiatury (Dostƒôpno≈õƒá WCAG)
                DOM.target.addEventListener('keydown', (e) => {
                    if (e.key === ' ' || e.key === 'Enter') {
                        e.preventDefault(); // Zapobiega przewijaniu strony spacjƒÖ
                        handleTargetClick();
                    }
                });

                // Listenery dla przycisk√≥w trudno≈õci
                DOM.difficultyButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        setDifficulty(button.dataset.difficulty);
                    });
                });

                // --- ZMIANA: LOGIKA PRZE≈ÅƒÑCZNIKA MOTYWU ---
                // Domy≈õlnie jest jasno, chyba ≈ºe w pamiƒôci zapisano 'dark'
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-theme');
                    DOM.themeToggleButton.textContent = '‚òÄÔ∏è';
                } else {
                    document.body.classList.remove('dark-theme');
                    DOM.themeToggleButton.textContent = 'üåô';
                }
    
                DOM.themeToggleButton.addEventListener('click', () => {
                    document.body.classList.toggle('dark-theme');
                    let isDark = document.body.classList.contains('dark-theme');
                    DOM.themeToggleButton.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                });
            }

            /**
             * Ustawia poziom trudno≈õci gry
             * @param {string} level - 'easy', 'medium', lub 'hard'
             */
            function setDifficulty(level) {
                if (gameState.isGameRunning) return; // Nie zmieniaj w trakcie gry

                gameConfig = {...difficultySettings[level] };
                
                // Aktualizacja UI przycisk√≥w
                DOM.difficultyButtons.forEach(button => {
                    button.classList.toggle('active', button.dataset.difficulty === level);
                });
                
                updateUI(); // Zaktualizuj czas na wy≈õwietlaczu
            }

            /**
             * Rozpoczyna nowƒÖ rundƒô gry
             */
            function startGame() {
                if (gameState.isGameRunning) return;

                // Reset stanu gry
                gameState.score = 0;
                gameState.timeLeft = gameConfig.time;
                gameState.isGameRunning = true;
                
                // Wyczy≈õƒá stare timery (na wszelki wypadek)
                clearInterval(gameState.gameTimer);
                clearInterval(gameState.targetInterval);

                // Aktualizacja UI
                updateUI();
                DOM.startButton.style.display = 'none';
                DOM.gameArea.classList.add('game-active'); // Dodaj po≈õwiatƒô
                DOM.difficultyButtons.forEach(b => b.disabled = true); // Zablokuj przyciski

                // Ustaw rozmiar celu
                DOM.target.style.width = `${gameConfig.size}px`;
                DOM.target.style.height = `${gameConfig.size}px`;
                
                DOM.target.style.display = 'block';
                moveTarget(); // Poka≈º cel po raz pierwszy

                // Uruchom timery
                gameState.gameTimer = setInterval(updateTimer, 1000);
            }

            /**
             * Ko≈Ñczy rundƒô gry
             */
            function endGame() {
                gameState.isGameRunning = false;
                clearInterval(gameState.gameTimer);
                clearInterval(gameState.targetInterval);

                // Odtw√≥rz d≈∫wiƒôk ko≈Ñca gry
                Sounds.end.currentTime = 0;
                Sounds.end.play();

                // Aktualizuj najlepszy wynik
                updateHighScore();

                // Ukryj UI gry
                DOM.target.style.display = 'none';
                DOM.gameArea.classList.remove('game-active');
                DOM.startButton.textContent = 'Zagraj ponownie?';
                DOM.startButton.style.display = 'block';
                DOM.difficultyButtons.forEach(b => b.disabled = false); // Odblokuj przyciski

                // Poka≈º modal SweetAlert2 zamiast alert()
                Swal.fire({
                    title: 'Koniec gry!',
                    html: `
                        <p style="font-size: 1.2em;">Tw√≥j wynik: <strong>${gameState.score}</strong></p>
                        <p style="font-size: 1.1em;">Najlepszy wynik: <strong>${gameState.highScore}</strong></p>
                    `,
                    icon: 'success',
                    confirmButtonText: 'Super!',
                });
            }

            /**
             * Obs≈Çuguje klikniƒôcie (lub naci≈õniƒôcie klawisza) na celu
             */
            function handleTargetClick() {
                if (!gameState.isGameRunning) return;

                gameState.score++;
                updateUI();

                // Odtw√≥rz d≈∫wiƒôk klikniƒôcia (z resetem)
                Sounds.click.currentTime = 0;
                Sounds.click.play();

                // Animacja klikniƒôcia
                DOM.target.classList.add('clicked');
                setTimeout(() => {
                    DOM.target.classList.remove('clicked');
                }, 50); // Czas trwania animacji.clicked

                moveTarget(); // Natychmiast przesu≈Ñ cel
            }

            /**
             * Przesuwa cel w losowe miejsce i resetuje timer automatycznego ruchu
             */
            function moveTarget() {
                if (!gameState.isGameRunning) return;

                // Wyczy≈õƒá stary interwa≈Ç automatycznego ruchu
                clearInterval(gameState.targetInterval);

                const areaWidth = DOM.gameArea.clientWidth;
                const areaHeight = DOM.gameArea.clientHeight;
                
                // U≈ºyj gameConfig dla rozmiaru
                const targetSize = gameConfig.size;

                const newX = Math.floor(Math.random() * (areaWidth - targetSize));
                const newY = Math.floor(Math.random() * (areaHeight - targetSize));

                DOM.target.style.left = `${newX}px`;
                DOM.target.style.top = `${newY}px`;

                // Aktywuj animacjƒô pojawienia siƒô
                DOM.target.classList.remove('appear');
                void DOM.target.offsetWidth; // Trigger reflow
                DOM.target.classList.add('appear');
                
                // Przenie≈õ fokus klawiatury na cel (Dostƒôpno≈õƒá WCAG)
                DOM.target.focus();

                // Ustaw nowy interwa≈Ç automatycznego ruchu
                gameState.targetInterval = setInterval(moveTarget, gameConfig.interval);
            }

            /**
             * Aktualizuje licznik czasu co sekundƒô
             */
            function updateTimer() {
                gameState.timeLeft--;
                updateUI();

                if (gameState.timeLeft <= 0) {
                    endGame();
                }
            }

            // --- 6. FUNKCJE POMOCNICZE (localStorage i UI) ---

            /**
             * Wczytuje najlepszy wynik z localStorage
             */
            function loadHighScore() {
                const storedHighScore = localStorage.getItem('catchGameHighScore');
                gameState.highScore = storedHighScore? parseInt(storedHighScore, 10) : 0;
            }

            /**
             * Aktualizuje najlepszy wynik, je≈õli obecny jest wy≈ºszy
             */
            function updateHighScore() {
                if (gameState.score > gameState.highScore) {
                    gameState.highScore = gameState.score;
                    localStorage.setItem('catchGameHighScore', gameState.highScore);
                }
                updateUI(); // Upewnij siƒô, ≈ºe UI jest zsynchronizowane
            }

            /**
             * Centralna funkcja do aktualizacji ca≈Çego interfejsu gry
             */
            function updateUI() {
                DOM.scoreDisplay.textContent = gameState.score;
                DOM.timeDisplay.textContent = gameState.isGameRunning? gameState.timeLeft : gameConfig.time;
                DOM.highScoreDisplay.textContent = gameState.highScore;
            }
            
            // --- 7. START APLIKACJI ---
            initGame();

        });
    </script>

    <!-- ZMIANA: Reklamy inne ni≈º Google AdSense przeniesione z do≈Çu (ju≈º tu ich nie ma) -->
    <!-- <div id="bottom-ad-scripts" ... > ... </div> -->

</body>
</html>


